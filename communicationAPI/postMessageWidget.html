<!doctype html>
<html>
 <head>
	<meta charset="UTF-8">
	<meta name="Generator" content="EditPlus®">
	<meta name="Author" content="王佳蕾">
	<meta name="Keywords" content="">
	<meta name="Description" content="">
	<title>postMessageWidget</title>
 </head>
 <body>
	<h1>widget iframe</h1>
	<p><b>Origin</b>:http://chat.example.net:9999</p>
	<p>Status set to:<strong id="status"></strong>by containing portal.</p>
	<div>
		<input type="text" id="messageText" value="Widget notification.">
		<button id="actionButton">Send Notification</button>
	</div>
	<p>
		This will ask the portal to notify the user.The portal does this by flashing the title.If the message comes from an origin other than http://chat.example.net:9999,the portal page will ignore it.
	</p>
	<script type="text/javascript">
		var trustedOrigin="http://portal.example.com:9999";
		function messageHandler(e){
			if(e.origin==="http://portal.example.com:9999"){
				document.getElementById("status").textContent=e.data;
			}else{
			}
		}
		function sendString(s){
			window.top.postMessage(s,trustedOrigin);
		}
		function loadDemo(){
			document.getElementById("actionButton").addEventListener("click",function(){
				var messageText=document.getElementById("messageText").value;
				sendString(messageText);
			},true);
		}
		window.addEventListener("load",loadDemo,true);
		window.addEventListener("message",messageHandler,true);
	</script>
 </body>
</html>
